language: java
jdk: openjdk15
before_install:
  - cd plugin
install:
  - mvn dependency:resolve
script:
  - mvn test

jobs:
  include:
    # Define the release stage that runs semantic-release
    - stage: release
      deploy:
        provider: script
        skip_cleanup: true
        script: >
          bash -c "echo 'DOWNLOADINg nvm.sh'";
          bash -c "curl -o ~/.nvm/nvm.sh https://raw.githubusercontent.com/creationix/nvm/v0.31.0/nvm.sh";
          bash -c "echo 'DOWNLOADINg lts'";
          bash -c "source ~/.nvm/nvm.sh; nvm install v16.10.0";
          bash -c "echo 'RUNNINg semantic-release'";
          bash -c "npx semantic-release";
        on:
          all_branches: true
